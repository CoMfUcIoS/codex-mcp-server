{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Codex MCP Server","text":"<p>MCP server wrapper for the OpenAI Codex CLI. Enable Claude Code (and other MCP clients) to use Codex locally via stdio.</p> <pre><code>graph LR\n    A[Claude Code / MCP Client] --&gt; B[Codex MCP Server]\n    B --&gt; C[codex]\n    B --&gt; L[listTools]\n    B --&gt; S[listSessions]\n    B --&gt; X[deleteSession]\n    B --&gt; T[sessionStats]\n    B --&gt; P[ping]\n    B --&gt; H[help]\n    B --&gt; M[listModels]\n    C --&gt; F[Codex CLI]\n    F --&gt; G[OpenAI API]\n    style A fill:#FF6B35\n    style B fill:#4A90E2\n    style C fill:#00D4AA\n    style L fill:#00D4AA\n    style S fill:#00D4AA\n    style X fill:#00D4AA\n    style T fill:#00D4AA\n    style P fill:#00D4AA\n    style H fill:#00D4AA\n    style M fill:#00D4AA\n    style F fill:#FFA500\n    style G fill:#FF9500\n</code></pre>   -   :rocket: **One\u2011click install**     ---     [VS Code](https://vscode.dev/redirect/mcp/install?name=codex-cli&amp;config=%7B%22type%22%3A%22stdio%22%2C%22command%22%3A%22npx%22%2C%22args%22%3A%5B%22-y%22%2C%22%40comfucios%2Fcodex-mcp-server%22%5D%7D) \u00b7     [VS Code Insiders](https://insiders.vscode.dev/redirect/mcp/install?name=codex-cli&amp;config=%7B%22type%22%3A%22stdio%22%2C%22command%22%3A%22npx%22%2C%22args%22%3A%5B%22-y%22%2C%22%40comfucios%2Fcodex-mcp-server%22%5D%7D) \u00b7     [Cursor](https://cursor.com/en/install-mcp?name=codex&amp;config=eyJ0eXBlIjoic3RkaW8iLCJjb21tYW5kIjoibnB4IC15IEBjb21mdWNpb3MvY29kZXgtbWNwLXNlcnZlciIsImVudiI6e319)  -   :gear: **MCP tools**     ---     `codex`, `listTools`, `listSessions`, `deleteSession`, `sessionStats`, `listModels`, `ping`, `help`  -   :shield: **Requirements**     ---     - Codex CLI (`npm i -g @openai/codex` or `brew install codex`)     - `codex login` or `OPENAI_API_KEY`     - Node \u2265 18.18"},{"location":"changelog/","title":"Changelog","text":""},{"location":"changelog/#101","title":"1.0.1","text":"<ul> <li>Initial public release (comfucios fork)</li> <li>Added tools: <code>listModels</code>, <code>deleteSession</code>, <code>sessionStats</code>, <code>listTools</code></li> <li>Pagination with expiring <code>nextPageToken</code> (~10 min)</li> <li>Session memory with TTL (<code>CODEX_SESSION_TTL_MS</code>) and size cap (<code>CODEX_SESSION_MAX_BYTES</code>)</li> <li>Image input support for <code>codex</code></li> <li>Model control for <code>gpt-5</code> with reasoning effort (<code>minimal|low|medium|high</code>)</li> </ul>"},{"location":"configuration/","title":"Configuration","text":"<p>Set these env vars in your editor/terminal as needed:</p> <pre><code>export OPENAI_API_KEY=...           # Required by Codex CLI unless logged in\nexport CODEX_PAGE_SIZE=40000        # Optional default page size (can be overridden per request with `pageSize` parameter)\nexport CODEX_SESSION_TTL_MS=3600000 # Optional session TTL (ms)\nexport CODEX_SESSION_MAX_BYTES=400000\n</code></pre> <p>The server itself runs over stdio (Model Context Protocol). No ports required.</p>"},{"location":"development/","title":"Development","text":"<pre><code>npm i\nnpm run dev     # tsx src/index.ts\nnpm run build   # tsc \u2192 dist/\nnpm start       # node dist/index.js\n</code></pre>"},{"location":"development/#tests-linting","title":"Tests &amp; linting","text":"<pre><code>npm test\nnpm run test:watch\nnpm run test:coverage\nnpm run lint\nnpm run lint:fix\nnpm run format\n</code></pre> <p>Project requires Node \u2265 18.18.</p>"},{"location":"faq/","title":"FAQ","text":"<p>Does it auto\u2011select a model? If you don\u2019t specify <code>model</code>, the server uses <code>\"gpt-5 medium\"</code>. You can override with <code>\"gpt-5 minimal|low|medium|high\"</code>.</p> <p>Can I resume an interactive Codex CLI session? This server runs Codex non\u2011interactively per request (with optional <code>sessionId</code> memory). There is no separate <code>resume</code> tool.</p> <p>Is the server stateful? Only when you pass <code>sessionId</code>. Otherwise, each call is stateless.</p> <p>Do I need to open a port? No. The server uses stdio (MCP).</p> <p>Tool discovery? Yes\u2014<code>listTools</code> returns all tools and their JSON schemas.</p> <p>How do I clear a session? Use <code>deleteSession</code> with <code>{ \"sessionId\": \"...\" }</code> or call <code>codex</code> with <code>{ \"sessionId\": \"id\", \"resetSession\": true, \"prompt\": \"...\" }</code>.</p> <p>How do I get session statistics? Use <code>sessionStats</code> with <code>{ \"sessionId\": \"...\" }</code>.</p> <p>How do I list all sessions with metadata? Use <code>listSessions</code>.</p>"},{"location":"install/","title":"Installation","text":""},{"location":"install/#oneclick-buttons","title":"One\u2011click buttons","text":"<ul> <li>Install in VS Code</li> <li>Install in VS Code Insiders</li> <li>Install in Cursor</li> </ul>"},{"location":"install/#manual","title":"Manual","text":"<pre><code>claude mcp add codex-cli -- npx -y @comfucios/codex-mcp-server\n</code></pre> <p>Node \u2265 18.18 is required.</p>"},{"location":"pagination/","title":"Pagination","text":"<p>When output exceeds <code>pageSize</code>, the server returns the first slice plus a <code>nextPageToken</code>.</p> <ol> <li>Call with your initial prompt.</li> <li>If <code>nextPageToken</code> is present, call again with <code>{ \"pageToken\": \"...\" }</code>.</li> <li>Repeat until the token is no longer returned.</li> </ol> <p>Tokens expire after ~10 minutes of inactivity.</p>"},{"location":"quickstart/","title":"Quickstart","text":""},{"location":"quickstart/#1-install-prerequisites","title":"1) Install prerequisites","text":"<pre><code>npm i -g @openai/codex   # or: brew install codex\ncodex login               # or export OPENAI_API_KEY=...\n</code></pre>"},{"location":"quickstart/#2-add-the-server","title":"2) Add the server","text":"Claude Code <pre><code>claude mcp add codex-cli -- npx -y @comfucios/codex-mcp-server\n</code></pre> Claude Desktop (macOS) <pre><code>{\n  \"mcpServers\": {\n    \"codex-cli\": {\n      \"command\": \"npx\",\n      \"args\": [\"-y\", \"@comfucios/codex-mcp-server\"]\n    }\n  }\n}\n</code></pre>"},{"location":"quickstart/#3-test-connection","title":"3) Test connection","text":"<p>Use the ping tool or ask the codex tool a simple prompt.</p>"},{"location":"tools/","title":"Tools API","text":"<p>This server exposes MCP tools that wrap the local Codex CLI. Outputs are cleaned (prompt/context echoes removed) and paginated when large.</p>"},{"location":"tools/#available-tools","title":"Available tools","text":"<ul> <li><code>codex</code></li> <li><code>listSessions</code></li> <li><code>deleteSession</code></li> <li><code>sessionStats</code></li> <li><code>listModels</code></li> <li><code>listTools</code></li> <li><code>ping</code></li> <li><code>help</code></li> </ul>"},{"location":"tools/#codex","title":"codex","text":"<p>Run the Codex CLI non\u2011interactively for code analysis, generation, or explanation. Supports conversational context (<code>sessionId</code>), pagination, image input, and model control.</p>"},{"location":"tools/#parameters","title":"Parameters","text":"<ul> <li><code>prompt</code> (string, optional): Coding task or question. Required on the first call unless you provide <code>pageToken</code>.</li> <li><code>sessionId</code> (string, optional): Stable ID to enable conversational context across calls.</li> <li><code>resetSession</code> (boolean, optional): If <code>true</code>, clears the session identified by <code>sessionId</code> before running.</li> <li><code>pageSize</code> (number, optional): Approximate characters per page (default <code>40000</code>, min <code>1000</code>, max <code>200000</code>).</li> <li><code>pageToken</code> (string, optional): Opaque token returned from a previous call to fetch the next chunk.</li> <li><code>model</code> (string, optional): Choose gpt\u20115 with reasoning effort, e.g. <code>\"gpt-5 minimal\" | \"gpt-5 low\" | \"gpt-5 medium\" | \"gpt-5 high\"</code>. Defaults to <code>\"gpt-5 medium\"</code>.</li> <li><code>image</code> (string or string[], optional): Path(s) to image file(s) for code/diagram analysis (passed to CLI as <code>--image</code>).</li> <li><code>approvalPolicy</code> (string, optional): Advanced. Codex CLI <code>--approval-policy</code>.</li> <li><code>sandbox</code> (boolean, optional): Advanced. Codex CLI <code>--sandbox</code>.</li> <li><code>workingDirectory</code> (string, optional): Advanced. Codex CLI <code>--working-directory</code>.</li> <li><code>baseInstructions</code> (string, optional): Advanced. Codex CLI <code>--base-instructions</code>.</li> </ul>"},{"location":"tools/#examples","title":"Examples","text":"<p>Single image:</p> <pre><code>{ \"prompt\": \"Explain this diagram\", \"image\": \"diagram.png\" }\n</code></pre> <p>Multiple images:</p> <pre><code>{ \"prompt\": \"Summarize these diagrams\", \"image\": [\"img1.png\", \"img2.jpg\"] }\n</code></pre>"},{"location":"tools/#notes-on-model-selection","title":"Notes on model selection","text":"<p>If you omit <code>model</code>, the server defaults to <code>\"gpt-5 medium\"</code>. Values are validated against an allowlist to avoid CLI errors; unsupported values fall back to <code>\"gpt-5 medium\"</code> while logging a warning.</p>"},{"location":"tools/#listtools","title":"listTools","text":"<p>Return a machine\u2011readable list of all tools with input schemas and descriptions (useful for client/LLM introspection).</p> <p>Example output (abridged):</p> <pre><code>[ { \"name\": \"codex\", \"description\": \"...\", \"inputSchema\": { \"type\": \"object\", \"properties\": { \"prompt\": { \"type\": \"string\" } } } } ]\n</code></pre>"},{"location":"tools/#listmodels","title":"listModels","text":"<p>List Codex models discovered from your local config files:</p> <ul> <li><code>~/.codex/config.toml</code></li> <li><code>~/.codex/config.yaml</code></li> <li><code>~/.codex/config.json</code></li> </ul> <p>Outputs a unique list of model names and optional descriptions (e.g., provider or profile). If no config is found or parsing fails, a clear error is returned.</p>"},{"location":"tools/#listsessions","title":"listSessions","text":"<p>Return all active sessions with metadata. Sessions expire automatically after <code>CODEX_SESSION_TTL_MS</code>.</p> <p>Returns per session:</p> <ul> <li><code>sessionId</code></li> <li><code>turns</code></li> <li><code>bytes</code></li> <li><code>createdAt</code> (ISO)</li> <li><code>lastUsedAt</code> (ISO)</li> <li><code>expiresAt</code> (ISO)</li> </ul>"},{"location":"tools/#deletesession","title":"deleteSession","text":"<p>Delete/expire a session by ID.</p> <p>Parameters:</p> <ul> <li><code>sessionId</code> (string, required)</li> </ul> <p>Returns: success/failure text</p>"},{"location":"tools/#sessionstats","title":"sessionStats","text":"<p>Detailed statistics for a single session.</p> <p>Parameters:</p> <ul> <li><code>sessionId</code> (string, required)</li> </ul> <p>Returns: formatted text with turns/bytes/timestamps</p>"},{"location":"tools/#ping","title":"ping","text":"<p>Echo test (defaults to <code>\"pong\"</code>).</p>"},{"location":"tools/#help","title":"help","text":"<p>Passthrough of <code>codex --help</code>.</p>"},{"location":"tools/#error-handling","title":"Error handling","text":"<p>All tools use a consistent error shape. Validation issues, CLI errors, and session/pagination errors produce:</p> <pre><code>{\n  \"isError\": true,\n  \"content\": [{ \"type\": \"text\", \"text\": \"...\" }]\n}\n</code></pre>"},{"location":"troubleshooting/","title":"Troubleshooting","text":""},{"location":"troubleshooting/#failed-to-start-server","title":"\"Failed to start server\"","text":"<ul> <li>Ensure Node \u2265 18.18.</li> <li>Make sure <code>@openai/codex</code> is installed and <code>codex --version</code> works.</li> </ul>"},{"location":"troubleshooting/#missing-required-prompt","title":"\"Missing required 'prompt'\"","text":"<ul> <li>First call must include <code>prompt</code> unless you\u2019re passing a valid <code>pageToken</code>.</li> </ul>"},{"location":"troubleshooting/#no-output-partial-output","title":"No output / partial output","text":"<ul> <li>Increase <code>pageSize</code> or follow the <code>nextPageToken</code>.</li> <li>Very large outputs may take time; the CLI is streamed and then paginated.</li> </ul>"},{"location":"troubleshooting/#sessions-not-remembered","title":"Sessions not remembered","text":"<ul> <li>Pass a stable <code>sessionId</code>.</li> <li>Session transcripts are trimmed when exceeding <code>CODEX_SESSION_MAX_BYTES</code> and expire after <code>CODEX_SESSION_TTL_MS</code>.</li> </ul>"},{"location":"troubleshooting/#windows-shells","title":"Windows shells","text":"<ul> <li>Prefer PowerShell or Git Bash; ensure <code>npx</code> is available on PATH.</li> </ul>"},{"location":"usage/","title":"Usage","text":""},{"location":"usage/#tools-overview","title":"Tools overview","text":"<ul> <li>codex \u2014 run the Codex CLI non\u2011interactively. Optional conversational context via <code>sessionId</code>.</li> <li>listSessions \u2014 list all active sessions with metadata (sessionId, turns, bytes, timestamps).</li> <li>deleteSession \u2014 delete/expire a session by sessionId.</li> <li>sessionStats \u2014 get statistics and metadata for a session.</li> <li>listModels \u2014 list models discovered from local <code>~/.codex</code> config.</li> <li>listTools \u2014 machine\u2011readable tool &amp; schema list.</li> <li>ping, help \u2014 utilities.</li> </ul>"},{"location":"usage/#codex-parameters","title":"Codex parameters","text":"Name Type Default Notes <code>prompt</code> string \u2014 Required on first call (unless paging). <code>pageSize</code> number 40000 1,000\u2013200,000 chars. <code>pageToken</code> string \u2014 Use token from previous paged response. <code>sessionId</code> string \u2014 Enables conversation memory within size limits. <code>resetSession</code> boolean false Clears given <code>sessionId</code> before running. <code>model</code> string gpt-5 medium One of: <code>gpt-5 minimal</code>, <code>gpt-5 low</code>, <code>gpt-5 medium</code>, <code>gpt-5 high</code>. <code>image</code> string or string[] \u2014 Path(s) to image files for code/diagram analysis. <code>approvalPolicy</code> string \u2014 Advanced\u2014passed to Codex CLI <code>--approval-policy</code>. <code>sandbox</code> boolean false Advanced\u2014Codex CLI <code>--sandbox</code>. <code>workingDirectory</code> string \u2014 Advanced\u2014Codex CLI <code>--working-directory</code>. <code>baseInstructions</code> string \u2014 Advanced\u2014Codex CLI <code>--base-instructions</code>."},{"location":"usage/#examples","title":"Examples","text":"<p>Single\u2011shot</p> <pre><code>{ \"prompt\": \"Explain this TypeScript function\" }\n</code></pre> <p>Paging through large output</p> <pre><code>{ \"prompt\": \"Summarize this repository in depth\", \"pageSize\": 10000 }\n</code></pre> <p>Response includes <code>{ \"meta\": { \"nextPageToken\": \"abc...\" } }</code> \u2192 call again:</p> <pre><code>{ \"pageToken\": \"abc...\" }\n</code></pre> <p>Conversational</p> <pre><code>{ \"sessionId\": \"issue-123\", \"prompt\": \"Draft tests for utils/sessionStore.ts\" }\n</code></pre> <p>Explicit model</p> <pre><code>{ \"prompt\": \"Write a Python script\", \"model\": \"gpt-5 high\" }\n</code></pre>"},{"location":"usage/#notes","title":"Notes","text":"<ul> <li>Page tokens expire ~10 minutes after the last use.</li> <li>Sessions expire after <code>CODEX_SESSION_TTL_MS</code> and trim once transcripts exceed <code>CODEX_SESSION_MAX_BYTES</code>.</li> </ul>"},{"location":"usage/#error-format","title":"Error format","text":"<pre><code>{\n  \"isError\": true,\n  \"content\": [{ \"type\": \"text\", \"text\": \"Missing required 'prompt' (or provide a 'pageToken').\" }]\n}\n</code></pre>"}]}